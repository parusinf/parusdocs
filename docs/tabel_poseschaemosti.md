# Табели посещаемости

## Запуск

1. Запустите **Парус**.
2. Приложение **Расчёт оплаты услуг учреждения**.

> _Если запускается другое приложение, откройте меню **Файл, Начать сеанс, Завершить сеанс работы** = Да, дождитесь появления окна входа в **Парус**, выберите нужное **Приложение** из ниспадающего списка_.

3. Меню **Учёт**.
4. Раздел **Табель посещаемости**.
5. При первом входе выберите каталог своего учреждения (структура слева).

## Настройка

> _Настройка производится один раз для каждого учреждения._

### Расчётный период

1. Правая кнопка мыши, **Вид**, включите **Панель инструментов**.
2. На панели инструментов нажмите кнопку **Сменить расчётный период** _либо_ правая кнопка мыши, **Сменить расчётный период**.
3. Установите текущий расчётный период.

> _Можно включать панели инструментов во всех разделах **Паруса**_.

### Группы

1. Правая кнопка мыши, **Настройки**, вкладка **Действия**.
2. Кликните два раза левой кнопкой мыши на элементе **Полный** в группе **Табель**.
3. Кликните кнопкой мыши на элементе **Расширения, Пользовательские отчёты**.
4. Переключитесь на появившуюся вкладку **Пользовательские отчёты**.
5. В строке **Табель посещаемости** в колонке **Использовать в меню** нажмите один раз левой кнопкой мыши на значении _Нет_, должно появиться значение _Да_.
6. Нажмите клавишу **F10** на клавиатуре, в колонке **Горячая клавиша** должно появиться значение **F10**.

> _Можно использовать любую другую клавишу или комбинацию клавиш, не занятую каким-либо действием_.

7. Переключитесь на вкладку **Прочие**, установите параметры:
* Определять объём выборки = _Да_
* Учитывать регистр символов = _Нет_
* Позиционирование в режиме списка = _Да_

8. Нажмите кнопку **ОК** на форме **Настройки**.
9. Отсортируйте группы по колонке **Мнемокод**.

> _Можно настраивать все разделы **Паруса**: выводить пользовательские отчёты, процедуры, приложения в контекстное меню (которое открывается по правой кнопке мыши), назначать горячие клавиши, показывать количество отобранных записей, сортировать по колонкам и прочее_.

### Табель

1. Откройте **Табель** любой группы:
* Кликните два раза левой кнопкой мыши на любой группе _либо_
* Правая кнопка мыши **Табель, Полный**.

2. Если появилось окно выбора типа часа, выберите **Тип часа** = _Д_ (дневной).
3. Растяните форму **Табель посещаемости** на весь экран, удерживая левой кнопкой мыши за края формы.
4. Правая кнопка мыши, **Настройки**, вкладка **Представления**.
5. Нажмите кнопку **Добавить**, введите наименование представления **Простое**.
6. Снимите флажки со всех колонок, заканчивающихся на _тд_.

> _Колонки с типом дня можно убирать, если не ведётся мониторинг посещаемости, а табель нужен только для начиления компенсации родительской платы._

7. **Количество зафиксированных колонок** = _3_ (Фамилия, Имя, Отчество).
8. **Итоги** = _По отобранным записям_.
9. Для каждой строки с днями от 1 до 31 в колонке **Итог** нажмите один раз левой кнопкой мыши на значении _нет_, должно появиться значение _количество_. 
10. Нажмите кнопку **ОК** на форме **Настройки**.
11. Отсортируйте детей по колонке **Фамилия**.
12. Нажмите кнопку **ОК** на форме **Табель посещаемости**.
13. Меню **Файл, Сервис, Параметры, ОК**. В структуре слева выберите раздел **Расчётные карточки**. Выберите `Светло-серый` цвет в настройке **Набор цветов для выделения выходных и праздничных дней в табеле посещаемости**.

### Расчётные карточки

1. Правая кнопка мыши, **Настройки**, вкладка **Прочие**, установите параметры:
* Определять объём выборки = _Да_
* Учитывать регистр символов = _Нет_

2. Нажмите кнопку **ОК** на форме **Настройки**.
3. Отсортируйте детей по колонке **Фамилия**.

## Формирование

Для ускорения заполнения табеля есть два варианта действий:
1. Заполняем весь табель явками при помощи действия **Сформировать по календарю**, а затем вручную убраем часы у тех детей, кто отсутствовал.
2. _Не_ используем формирование по календарю, а только растравляем часы у тех, кто посещал.

> _Если явок больше неявок, то вариант 1, иначе вариант 2. Для редактирования откройте табель двойным кликом мышки либо в правая кнопка мыши, **Табель, Полный**._

Для формирования табеля по календарю:

1. Отметьте все группы: кликните на галочку слева от названий колонок.
2. Правая кнопка мыши, **Функции, Сформировать по календарю**.

Для редактирования табеля:

1. Откройте каждую группу двойным кликом мышки и удалитие часы клавишей **Delete** у детей, которые не посещали учреждение в определённые дни.

## Печать

1. Нажмите клавишу **F10** _либо_ правая кнопка мыши, **Табель посещаемости** _либо_ правая кнопка мыши, **Расширения, Пользовательские отчёты, Табель посещаемости**.
2. Заполните параметры отчёта:
* Начало периода = _01.06.2018_
* Окончание периода = _30.06.2018_
* Учреждение = _ш26Б_
* Подразделение = _Здание яс52_
* Услуги = _Посещение детсада;Родительская плата_
3. Нажмите **ОК** и дождитесь формирования отчёта.

> _**Учреждение** должно совпадать с мнемокодом учреждения, **Подразделение** должно быть указано только для объединённых учреждений, как в примере выше._

> _[Перчать в безплатный офисный пакет **LibreOffice**](libreoffice.md)._

## Мобильное приложение

### Установка приложения **Табели посещаемости**

[https://github.com/parusinf/timesheets#23-установка](https://github.com/parusinf/timesheets#23-установка)

### Получение табелей

из учётной системы **Парус** в мобильное приложение **Табели посещаемости**  с помощью телеграм-бота: 
https://t.me/timesheets_support/16

### Отправка табелей

из мобильного приложения в Парус происходит автоматически при включенной по умолчанию настройке **Интеграция с Парусом**

### Техподдержка

мобильного приложения и телеграм-бота: https://t.me/timesheets_support

### Получение и отправка табелей вручную:

1. Чтобы не вводить в приложении группы вручную, выгрузите их из Паруса: **Учёт, Табель посещаемости**, на группе, которую нужно выгрузить, правая кнопка мыши, **Обмен, Экспорт в файл**, укажите каталог на компьютере, куда выгружать `CSV файл` группы, пользовательская процедура **ВыгрузкаТабеля**.
2. Передайте `CSV файл` на телефон через почту или Telegram.
3. На телефоне откройте `CSV файл` приложением **Табели посещаемости** либо в самом приложении нажмите кнопку загрузки и выберите `CSV файл`.
4. Выгрузите заполненный табель группы из приложения в `CSV файл`.
5. Передайте `CSV файл` на компьютер через почту или Telegram.
6. Загрузите `CSV файл` в Парус: **Учёт, Табель посещаемости**, правая кнопка мыши, **Обмен, Импорт из файл**, укажите `CSV файл` на компьютере, который нужно загрузить, пользовательская процедура **ЗагрузкаТабеля**.

> _Серверные объекты процедур импорта и экспорта `CSV файлов` табелей посещаемости: [https://github.com/parusinf/timesheets/blob/master/lib/db/parus_load_unload.sql](https://github.com/parusinf/timesheets/blob/master/lib/db/parus_load_unload.sql)_
